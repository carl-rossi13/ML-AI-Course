## Research question: How can machine learning be used to predict the stock market?
### Expected data sources: 
The primary data source I expect to use is the yfinance Python library, which utilizes historical market data from Yahoo Finance. 
### Techniques used: 
Features will be engineered that utilize technical and macro fundamental market analysis. Technical features will be engineered to capture aspects of market psychology, for example the observation that declining volume during a price trend may indicate potential continuation of that trend. This idea stems from the notion that market movements reflect collective human behavior. To represent this, a volume-anchored moving average will be employed, highlighting how increased trading activity (volume) often corresponds to the establishment of new trends, while reduced volume can signify a consolidation or continuation phase as the trend stabilizes. Other technical features may be engineered using similar logic based on price and volume data. Macro fundamental features may incorporate economic indicators (e.g. GDP, CPI, CCI, etc.), monetary policy (Central Bank Rates, Money Supply, etc.), and commodity prices (Oil, Gold, etc.).
Once the features are engineered and scaled (if applicable), they will be input into two decision trees. One tree will attempt to predict the high of the target stock, and the other tree will attempt to predict the low of the target stock. Decision trees will be utilized due to their scalability and versatility. Random Forest, lightGBM, or XGBoost algorithms will be evaluated based on their ability to predict the continuous variable (stock high or low), using RMSE and MSE due to their sensitivity to variance. 
### Expected results: 
Prediction of the high and low of a stock over a set period, with an emphasis on precision and confidence. These two values can then be used with the current price of the target stock to predict the Risk-Reward of buying or selling the target stock.  
### Why is this research question important:
This research can benefit institutional and retail investors, portfolio managers, and policymakers by providing advanced tools for risk assessment, portfolio optimization, and market trend analysis.

# UPDATE: 

## Preliminary Results: 
My research question has evolved slightly to be more direct, shifting from “How can machine learning be used to predict the stock market?” to “How can machine learning be used to make money in the stock market?” To explore this, I have developed two machine learning models for trading Apple stock (AAPL): a SARMA model as a baseline and a LightGBM model as a more advanced approach. AAPL was selected due to its over 40 years of historical data and its significance in the market (market capitalization, liquidity, and ETF weighting). However, I chose to use data from 2008 to the present to account for changing market conditions. Additionally, AAPL's strong relationships with key indices—S&P 500 (SPY), NASDAQ (QQQ), and the U.S. dollar currency index (DX-Y.NYB)—make it an ideal candidate for analysis, with all data being sourced via the Yahoo Finance (yfinance). The dataset spans 4,094 rows from January 1, 2009, to February 10, 2025, before processing.

I incorporated data from three benchmark indices along with AAPL’s own historical data to engineer meaningful features as inputs for my LightGBM model(s). First, I established a simple yet competitive baseline using two SARMA models—one to predict the target period high price and the other for the target period low price. SARMA was chosen as the baseline model due to the time-series nature of the data, its seasonal patterns, and its widespread use in financial forecasting. The primary evaluation metric for my models is Mean Squared Error (MSE), as minimizing large errors is critical in financial contexts where significant deviations can impact portfolio size. Additionally, total cumulative return serves as a secondary metric to assess the practical profitability of the models.

A total of 21 unique features were engineered and used as inputs for my composite LightGBM model. To fairly compare SARIMA and LightGBM, the final 1% (~2 months) of data was reserved for ‘live testing’, simulating real-world deployment in a paper trading account. Performance was evaluated using MSE and cumulative returns during this period. The SARIMA High model achieved an MSE of 16.39, while the SARIMA Low model had an MSE of 12.92, resulting in a cumulative return of -0.27%. In contrast, the LightGBM model recorded MSE values of 184.09 (High) and 149.1 (Low), but outperformed in cumulative returns with a gain of 0.7%. Notably, during training and testing, LightGBM performed significantly better, with an average High MSE of 27.24 and Low MSE of 37.54 over 10 TimeSeriesSplit validation steps. It is important to highlight that no hyperparameter tuning or feature optimization has been conducted for either model yet.

# Link
https://github.com/carl-rossi13/ML-AI-Course/blob/main/Capstone/capstone.ipynb
